---
title: "Common Vulnerabilities and Exposures Analysis"
author: "Alessandro Zanatta"
output: ioslides_presentation
---

```{r setup, include=FALSE}
require("knitr")
knitr::opts_chunk$set(echo = TRUE)
opts_knit$set(root.dir = "C:/Users/aless/Documents/Universita/Secondo_anno/secondo_semestre/data_science/CVE_Project")
```

```{r, echo=FALSE, warning=FALSE}
library(tibble)
library(dplyr)
library(ggplot2)
```

```{r echo=FALSE}
# Import

# Set working directory
setwd("C:/Users/aless/Documents/Universita/Secondo_anno/secondo_semestre/data_science/CVE_Project")


# Import datasets

# NVD dataset
all_cve = read.csv("datasets/mitre/allitems.csv")

# Kaggle datasets
cve = read.csv("datasets/kaggle/cve.csv")
products = read.csv("datasets/kaggle/products.csv")
vendor_product = read.csv("datasets/kaggle/vendor_product.csv")
vendors = read.csv("datasets/kaggle/vendors.csv")


# Pretty view

# View(all_cve)
# View(cve)
# View(products)
# View(vendor_product)
# View(vendors)

```


```{r, echo=FALSE}

# Tidy

# We can see that the dataset from MITRE contains a header that is not related to the dataset.
# Column names are also not correct. These are stored in the header we just mentioned.
# We should also note that rows are the CVE codes. Let's make them being the first column instead.


# Delete the first 9 rows
all_cve = all_cve %>%
  slice(10:n())

# Change column names
all_cve = all_cve %>%
  rename("Status" = "CVE.Version.20061101") %>%
  rename("Description" = "X") %>%
  rename("References" = "X.1") %>%
  rename("Phase" = "X.2") %>%
  rename("Votes" = "X.3") %>%
  rename("Comments" = "X.4")

# Make the CVE code a column in the dataset
all_cve = tibble::rownames_to_column(all_cve, "Code")

# View(all_cve)


# We can also notice that there is a redundant column in the vendor's product dataset. 
# It is basically a duplicate of the row number, so we can simply remove it.

# Remove redundant column
vendor_product = vendor_product %>% select(-X)

# Datasets are now clean and we can start the analysis.
```

# What are the Common Vulnerabilities and Exposures (CVE)?


